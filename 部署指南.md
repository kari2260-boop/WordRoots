# 🚀 PathForge Web 部署指南

## 推荐方案：Vercel（免费 + 中国访问快）

---

## 📋 部署前准备

### 1. 确保环境变量文件存在

检查 `.env.local` 文件包含以下内容：

```env
# Supabase 配置
NEXT_PUBLIC_SUPABASE_URL=你的Supabase项目URL
NEXT_PUBLIC_SUPABASE_ANON_KEY=你的Supabase匿名密钥
SUPABASE_SERVICE_ROLE_KEY=你的Supabase服务密钥

# AI 配置
CUSTOM_API_KEY=sk-UQsnpfuLJYL2jIGYVkbjMcSdFcsUF04imYD4aY5OWI82araI
DEEPSEEK_API_KEY=sk-e483945393294ce5b8d0077935fa0192
```

⚠️ **重要**：这些环境变量需要在 Vercel 后台配置，不要提交到 Git！

---

## 🔧 第一步：创建 GitHub 仓库

### 1. 访问 GitHub
- 打开：https://github.com
- 登录你的账号（如果没有，先注册一个）

### 2. 创建新仓库
- 点击右上角 "+" -> "New repository"
- 仓库名：`pathforge-web`
- 设置为 **Private**（私有仓库，保护代码）
- 不要勾选 "Initialize with README"
- 点击 "Create repository"

### 3. 推送代码到 GitHub

在项目目录执行以下命令：

```bash
# 1. 添加所有文件
git add .

# 2. 创建第一次提交
git commit -m "Initial commit: PathForge Web"

# 3. 添加远程仓库（替换成你的 GitHub 用户名）
git remote add origin https://github.com/你的用户名/pathforge-web.git

# 4. 推送代码
git branch -M main
git push -u origin main
```

---

## 🌐 第二步：部署到 Vercel

### 1. 注册 Vercel 账号
- 访问：https://vercel.com
- 点击 "Sign Up"
- **推荐**：使用 GitHub 账号登录（一键授权）

### 2. 导入项目
1. 登录后，点击 "Add New..." -> "Project"
2. 选择 "Import Git Repository"
3. 找到你的 `pathforge-web` 仓库
4. 点击 "Import"

### 3. 配置项目

**Framework Preset**: Next.js（自动检测）

**Root Directory**: `./`（默认）

**Build Command**: `npm run build`（默认）

**Output Directory**: `.next`（默认）

### 4. 配置环境变量 ⚠️ 重要！

在 "Environment Variables" 部分，添加以下变量：

```
NEXT_PUBLIC_SUPABASE_URL = 你的Supabase项目URL
NEXT_PUBLIC_SUPABASE_ANON_KEY = 你的Supabase匿名密钥
SUPABASE_SERVICE_ROLE_KEY = 你的Supabase服务密钥
CUSTOM_API_KEY = sk-UQsnpfuLJYL2jIGYVkbjMcSdFcsUF04imYD4aY5OWI82araI
DEEPSEEK_API_KEY = sk-e483945393294ce5b8d0077935fa0192
```

**注意**：
- 每个变量单独添加
- 不要有引号
- 确保所有环境都选中（Production, Preview, Development）

### 5. 部署
- 点击 "Deploy"
- 等待 2-3 分钟
- 部署成功后会显示网址，例如：`https://pathforge-web.vercel.app`

---

## 🔗 第三步：配置 Supabase

### 1. 添加 Vercel 域名到 Supabase

1. 访问 Supabase 控制台：https://supabase.com/dashboard
2. 选择你的项目
3. 进入 "Authentication" -> "URL Configuration"
4. 在 "Site URL" 添加你的 Vercel 域名：
   ```
   https://pathforge-web.vercel.app
   ```
5. 在 "Redirect URLs" 添加：
   ```
   https://pathforge-web.vercel.app/**
   ```

### 2. 更新 CORS 设置（如果需要）

在 Supabase 项目设置中，确保允许你的 Vercel 域名访问。

---

## 🎯 第四步：测试部署

### 1. 访问你的网站
打开 Vercel 提供的网址，例如：
```
https://pathforge-web.vercel.app
```

### 2. 测试功能
- ✅ 登录/注册
- ✅ 学生端功能
- ✅ 管理员端功能
- ✅ AI 聊天
- ✅ 作品提交和审批

### 3. 检查错误
如果有问题，在 Vercel 控制台查看：
- "Deployments" -> 点击最新部署 -> "Logs"

---

## 🔄 第五步：自动部署（可选）

### 设置自动部署

每次推送代码到 GitHub，Vercel 会自动部署：

```bash
# 修改代码后
git add .
git commit -m "更新功能"
git push

# Vercel 会自动检测并部署
```

---

## 🌍 第六步：绑定自定义域名（可选）

### 1. 购买域名
推荐平台：
- 阿里云：https://wanwang.aliyun.com
- 腾讯云：https://dnspod.cloud.tencent.com
- Cloudflare：https://www.cloudflare.com

### 2. 在 Vercel 添加域名
1. 进入项目 -> "Settings" -> "Domains"
2. 输入你的域名，例如：`pathforge.com`
3. 按照提示配置 DNS 记录

### 3. 配置 DNS
在域名服务商添加 CNAME 记录：
```
类型: CNAME
名称: @（或 www）
值: cname.vercel-dns.com
```

等待 DNS 生效（通常 5-30 分钟）

---

## 📊 监控和维护

### 1. 查看访问统计
- Vercel 控制台 -> "Analytics"
- 查看访问量、性能等数据

### 2. 查看日志
- Vercel 控制台 -> "Deployments" -> 选择部署 -> "Logs"
- 查看错误和警告

### 3. 性能优化
- Vercel 自动提供 CDN 加速
- 自动压缩图片和资源
- 自动 HTTPS

---

## 🛡️ 安全建议

### 1. 保护环境变量
- ✅ 不要提交 `.env.local` 到 Git
- ✅ 在 Vercel 后台配置环境变量
- ✅ 定期更换 API 密钥

### 2. 设置访问限制
- 在 Supabase 设置 RLS（Row Level Security）
- 限制 API 调用频率
- 监控异常访问

### 3. 备份数据
- 定期备份 Supabase 数据库
- 导出重要数据

---

## 🆘 常见问题

### Q1: 部署后页面空白
**解决**：检查 Vercel 日志，确认环境变量是否正确配置

### Q2: 登录失败
**解决**：检查 Supabase 的 Site URL 和 Redirect URLs 是否包含 Vercel 域名

### Q3: AI 聊天不工作
**解决**：确认 `CUSTOM_API_KEY` 和 `DEEPSEEK_API_KEY` 已在 Vercel 配置

### Q4: 中国访问慢
**解决**：
- Vercel 在中国有 CDN 节点，通常很快
- 如果还是慢，考虑使用自定义域名 + Cloudflare CDN

### Q5: 数据库连接失败
**解决**：检查 Supabase 项目是否暂停（免费版长期不用会暂停）

---

## 📞 获取帮助

- Vercel 文档：https://vercel.com/docs
- Next.js 文档：https://nextjs.org/docs
- Supabase 文档：https://supabase.com/docs

---

## ✅ 部署检查清单

部署前确认：
- [ ] 代码已推送到 GitHub
- [ ] Vercel 项目已创建
- [ ] 所有环境变量已配置
- [ ] Supabase URL 配置已更新
- [ ] 部署成功（绿色勾）
- [ ] 网站可以访问
- [ ] 登录功能正常
- [ ] AI 聊天正常
- [ ] 数据库读写正常

---

🎉 **恭喜！你的 PathForge Web 已经上线了！**

现在任何人都可以通过你的 Vercel 网址访问你的网站。
